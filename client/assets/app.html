<!DOCTYPE html>
<html>
<head>
  <title>Tomato Radio Automation</title>

  <link href="css/nes.min.css" rel="stylesheet">
  <link href="css/styles.css" rel="stylesheet">

  <script src="js/jquery.min.js"></script>
  <script src="js/base.js"></script>
  <script src="js/login.js"></script>
</head>
<body>
  <div id="loading"></div>

  <div id="app">
    <header>
      <!-- 1. Convert header contents to flex
           2. Swap status and menu
        -->
      <div id="dropdown">
        <button class="nes-btn btn-primary">
          &#x00BB;
        </button>
        <div>
          <div class="nes-container is-rounded">
            <p>
              <button class="nes-btn is-primary" onclick="cef.internal.toggle_fullscreen();">Toggle Fullscreen</button>
              <button class="nes-btn is-warning" onclick="showModal('logout-dialog');">Logout</button>
              <button class="nes-btn is-error" onclick="showModal('close-dialog');">Quit</button>
            </p>
          </div>
        </div>
      </div>

      <h1>
        <img src="images/tomato.png">
        Tomato Radio Automation
        <img src="images/tomato.png">
      </h1>

      <div id="connection-status" class="nes-text is-warning nes-pointer" data-content="loading">
        *
      </div>
    </header>

    <section>
      <div class="nes-container with-title">
        <p class="title">Now Playing</p>
        <div class="progress-text" data-text="hi mom">
          <progress class="nes-progress is-primary" value="50" max="100" data-text-fill="test content test content test content"></progress>
        </div>
      </div>
    </section>

    <main style="display: flex; align-items: stretch; height: 100%;">
      <div class="nes-container with-title" style="display: flex; align-items: stretch; flex-direction: column; padding-right: 0.25rem; width: 100vw;">
        <p class="title" style="align-self: flex-start;">Main Content</p>
        <div style="display: flex; align-items: stretch;">
          <div style="overflow-y: auto; padding-right: 1.75rem;">
            <p>
              <button class="nes-btn is-warning" onclick="sync()">Test Sync</button>
              <button class="nes-btn is-warning" onclick="assetLoadTest()">Load Assets Test</button>
            </p>
            <div id="asset-list"></div>
            <p>
              <script>
                // XXX Write out some number of lorems
                var numWords = Math.floor(Math.random() * 1500);
                var loremWords = [
                  'Lorem', 'ipsum', 'dolor', 'sit', 'amet,', 'consectetur', 'adipisicing', 'elit,',
                  'sed', 'do', 'eiusmod', 'tempor', 'incididunt', 'ut', 'labore', 'et', 'dolore',
                  'magna', 'aliqua.', 'Ut', 'enim', 'ad', 'minim', 'veniam,', 'quis', 'nostrud',
                  'exercitation', 'ullamco', 'laboris', 'nisi', 'ut', 'aliquip', 'ex', 'ea', 'commodo',
                  'consequat.', 'Duis', 'aute', 'irure', 'dolor', 'in', 'reprehenderit', 'in',
                  'voluptate', 'velit', 'esse', 'cillum', 'dolore', 'eu', 'fugiat', 'nulla',
                  'pariatur.', 'Excepteur', 'sint', 'occaecat', 'cupidatat', 'non', 'proident,', 'sunt',
                  'in', 'culpa', 'qui', 'officia', 'deserunt', 'mollit', 'anim', 'id', 'est', 'laborum.'
                ]

                for (var i = 0; i < numWords; i++) {
                  var word = loremWords[i % loremWords.length];
                  document.write(word + ' ');
                }
              </script>
            </p>
          </div>
        </div>
      </div>
    </main>

    <footer>
      <p class="center">
        Copyright &copy; 2019-<script>document.write('' + (new Date()).getFullYear());</script>,
        <a class="link" href="mailto:david.cooper@burningman.org">David Cooper</a> &amp;
        <a class="link" href="https://bmir.org">BMIR</a>. All rights reserved.
      </p>
    </footer>

  </div>

  <!-- Login dialog -->
  <dialog class="nes-dialog is-rounded" id="login-dialog">
    <form method="dialog">
      <p class="title">Please Login</p>

      <div id="login-errors"></div>

      <div class="nes-field is-inline">
        <label for="hostname">Host:</label>
        <input type="text" id="hostname" class="nes-input" placeholder="eg. tomato.host.com or 1.2.3.4">
      </div>
      <div class="center">
        <label>
          <input type="radio" class="nes-radio" name="protocol" value="https" checked>
          <span>Secure (https)</span>
        </label>
        <label>
          <input type="radio" class="nes-radio" name="protocol" value="http">
          <span>Insecure (http)</span>
        </label>
      </div>
      <div class="nes-field is-inline auth-field">
        <label for="username">Username:</label>
        <input type="text" id="username" class="nes-input" placeholder="Enter username">
      </div>
      <div class="nes-field is-inline auth-field">
        <label for="password">Password:</label>
        <input type="password" id="password" class="nes-input" placeholder="Enter password">
      </div>
      <menu class="dialog-menu right">
        <button class="nes-btn is-success">Login</button>
      </menu>
    </form>
  </dialog>

  <!-- External link dialog -->
  <dialog class="nes-dialog is-rounded" id="link-dialog">
    <form method="dialog">
      <p class="title">Open Link</p>
      <p>Open in external browser?
        <br><span class="nes-text is-primary" id="link-url"></span>
      </p>
      <menu class="dialog-menu right">
        <button class="nes-btn is-error">Cancel</button>
        <button class="nes-btn is-success" id="link-open-btn">Yes, open it!</button>
      </menu>
    </form>
  </dialog>

  <!-- Logout dialog -->
  <dialog class="nes-dialog is-rounded" id="logout-dialog">
    <form method="dialog">
      <p class="title">Logout</p>
      <p>
        <span class="nes-text is-error">
          Are you sure you want to logout?
        </span>
      </p>
      <menu class="dialog-menu right">
        <button class="nes-btn">Cancel</button>
        <button class="nes-btn is-error" id="confirm-logout-btn">Logout</button>
      </menu>
    </form>
  </dialog>

  <!-- Quit dialog -->
  <dialog class="nes-dialog is-rounded" id="close-dialog">
    <form method="dialog">
      <p class="title">Quit Tomato</p>
      <p>
        <span class="nes-text is-error">
          Are you sure you want to quit Tomato?
        </span>
      </p>
      <menu class="dialog-menu right">
        <button class="nes-btn">Cancel</button>
        <button class="nes-btn is-error" id="close-btn">Quit Tomato</button>
      </menu>
    </form>
  </dialog>

</body>
</html>
