<!DOCTYPE html>
<html>
<head>
  <title>Tomato Radio Automation</title>

  <link href="css/nes-2.3.0.min.css" rel="stylesheet">
  <link href="css/styles.css" rel="stylesheet">

  <script src="js/jquery-3.4.1.min.js"></script>
  <script src="js/mustache-3.1.0.min.js"></script>
  <script src="js/base.js"></script>
  <script src="js/login.js"></script>
</head>
<body>
  <div id="loading"></div>

  <div id="app">
    <header>
      <!-- 1. Convert header contents to flex
           2. Swap status and menu
        -->
      <div id="dropdown">
        <button class="nes-btn btn-primary">
          &#x00BB;
        </button>
        <div>
          <div class="nes-container is-rounded">
            <p>
              <button class="nes-btn is-success" onclick="sync();">Sync</button>
              <button class="nes-btn" onclick="loadBlock();">Load Block</button>
              <button class="nes-btn is-primary" onclick="cef.bridge.toggle_fullscreen();">Toggle Fullscreen</button>
              <button class="nes-btn is-warning" onclick="showModal('logout-dialog');">Logout</button>
              <button class="nes-btn is-error" onclick="showModal('close-dialog');">Quit</button>
            </p>
          </div>
        </div>
      </div>

      <h1>
        <img src="images/tomato.png">
        Tomato Radio Automation
        <img src="images/tomato.png">
      </h1>

      <div id="connection-status" class="nes-text is-warning nes-pointer" data-content="loading">
        *
      </div>
    </header>

    <section>
      <div class="nes-container with-title">
        <p class="title">Now Playing</p>

        <progress class="nes-progress is-primary" value="50" max="100" data-text-fill="test content test content test content test content test content test content test content test content test content"></progress>
      </div>
    </section>

    <main>
      <div id="play-queue-container" class="nes-container with-title">
        <p class="title">Play Queue</p>
        <div>
          <script id="play-queue-template" type="text/x-mustache">
            {{# errors.length }}
              <div class="nes-container with-title">
                <p class="title">Error Loading Stop Set</p>
                 <ul class="nes-list is-circle">
                  {{# errors }}
                    <li>{{ . }}</li>
                  {{/ errors }}
                  </ul>
              </div>
            {{/ errors.length }}

            {{# stopset }}
              <div class="nes-container with-title">
                <p class="title">{{ . }}</p>
                <div class="lists">
                  <ul class="nes-list is-circle">
                  {{# assets }}
                    <li>
                      <span style="background-color: #{{color}}">[{{ rotator }}]</span>
                      {{ name }}<br>
                      <audio src="{{ url }}" controls></audio>
                    </li>
                  {{/ assets }}
                  </ul>
                </div>
              </div>
            {{/ stopset }}

            <div class="nes-container with-title">
              <p class="title">Wait</p>
              <p>Wait for {{ wait }} seconds</p>
            </div>
          </script>
          <div id="play-queue"></div>
        </div>
      </div>
    </main>

    <footer>
      <p class="center">
        Copyright &copy; 2019-<script>document.write('' + (new Date()).getFullYear());</script>,
        <a href="mailto:david.cooper@burningman.org" data-description="david.cooper@burningman.org">David Cooper</a> &amp;
        <a href="https://bmir.org" data-description="bmir.org">BMIR</a>. All rights reserved.
      </p>
    </footer>

  </div>

  <script id="dialog-template" type="text/x-mustache">
    <dialog class="nes-dialog is-rounded" id="{{ id }}-dialog">
      <form method="dialog">
        <p class="title">{{ title }}</p>
        <p>
          {{# body_html }}{{& body_html }}{{/ body_html }}
          {{# body }}<span class="nes-text is-error">{{ body }}</span>{{/ body }}
        </p>
        <menu class="dialog-menu right">
          {{# buttons }}
            <button class="nes-btn{{ #class }} {{ class }}{{/ class }}"{{# id }} id="{{ id }}"{{/ id }}>
              {{ text }}
            </button>
          {{/buttons}}
        </menu>
      </form>
    </dialog>
  </script>

  <script id="login-template" type="text/x-mustache">
    <div id="login-errors"></div>

    <div class="nes-field is-inline">
      <label for="hostname">Host:</label>
      <input type="text" id="hostname" class="nes-input" placeholder="eg. tomato.host.com or 1.2.3.4">
    </div>
    <div class="center">
      <label>
        <input type="radio" class="nes-radio" name="protocol" value="https" checked>
        <span>Secure (https)</span>
      </label>
      <label>
        <input type="radio" class="nes-radio" name="protocol" value="http">
        <span>Insecure (http)</span>
      </label>
    </div>
    <div class="nes-field is-inline auth-field">
      <label for="username">Username:</label>
      <input type="text" id="username" class="nes-input" placeholder="Enter username">
    </div>
    <div class="nes-field is-inline auth-field">
      <label for="password">Password:</label>
      <input type="password" id="password" class="nes-input" placeholder="Enter password">
    </div>
  </script>

</body>
</html>
